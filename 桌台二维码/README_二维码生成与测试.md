# 📱 桌台二维码生成与测试指南

## 🎯 **概述**

本文档说明如何生成桌台二维码，以及在微信开发者工具中通过二维码编译启动小程序进行测试。

## 🔧 **获取二维码**

### **方式1：使用现成的二维码（推荐）**

在 `桌台二维码/` 文件夹中已经准备了多个桌台二维码，你可以直接使用：

- **桌台A01**：`桌台二维码/A01.png`
- **桌台A02**：`桌台二维码/A02.png`
- **桌台A03**：`桌台二维码/A03.png`
- **更多桌台**：查看文件夹中的其他二维码

### **方式2：生成新的二维码**

如果需要生成新的桌台二维码，请按以下步骤操作：

#### **⚠️ 重要提醒**

**在生成二维码之前，必须先完成WeChat配置！**

1. **查看配置说明**：请先阅读 `README_WeChat_Config.md` 文档
2. **更新小程序配置**：修改 `miniprogram-1/project.config.json` 中的 `appid`，确保与你的AppID一致
3. **配置后端参数**：更新 `ConsoleApp1/appsettings.json` 中的WeChat配置

#### **生成步骤**

**步骤1：启动后端服务**
```bash
cd ConsoleApp1
dotnet run
```

后端服务将在 `http://localhost:5002` 启动。

**步骤2：访问二维码测试页面**

在浏览器中访问：`http://localhost:5002/qrcode-test.html`

**步骤3：生成二维码的方式**

- **单个桌台二维码**：输入桌台号，选择店铺ID，点击"生成二维码"
- **批量生成二维码**：输入桌台号列表，选择店铺ID，点击"批量生成"
- **范围生成二维码**：输入起始和结束桌台号，选择店铺ID，点击"范围生成"

## 📱 **微信开发者工具测试**

### **1. 打开微信开发者工具**

- 启动微信开发者工具
- 选择"导入项目"
- 选择项目目录：`miniprogram-1`
- 填入你的AppID

### **2. 通过二维码编译启动**

#### **步骤1：选择编译方式**
- 在开发者工具顶部找到"编译"按钮
- 点击"编译"按钮旁边的下拉箭头
- 选择"快速 二维码编译"

#### **步骤2：选择二维码图片**
- 开发者工具会弹出文件选择对话框
- 选择之前生成的桌台二维码图片文件
- 支持PNG、JPG等常见图片格式

#### **步骤3：启动小程序**
- 选择二维码图片后，小程序会自动启动
- 在模拟器中可以看到小程序运行效果
- 控制台会显示参数解析过程

### **3. 验证参数传递**

#### **控制台输出示例**
```
页面参数: {tableNumber: "A01&storeId=1"}
解码后的tableNumber: A01&storeId=1
标准化后的字符串: A01&storeId=1
解析后的参数: {tableNumber: "A01", storeId: 1}
✅ 从二维码进入小程序
桌台号: A01
店铺ID: 1
📱 点餐开发组参考：
店铺ID: 1
桌台号: A01
这两个参数可以用于：
1. 调用后端API获取菜单
2. 提交订单时标识桌台
3. 查询桌台状态
```

#### **页面显示效果**
- 显示桌台信息卡片
- 店铺ID：1
- 桌台号：A01
- 开发组参考说明

## 🧪 **测试流程**

### **完整测试步骤**

1. **准备二维码**
   - **使用现成的二维码**：从 `桌台二维码/` 文件夹中选择（推荐）
   - **或生成新二维码**：按照"方式2"的步骤操作

2. **配置检查（重要！）**
   - 确保已阅读 `README_WeChat_Config.md`
   - 检查 `miniprogram-1/project.config.json` 中的 `appid` 是否与你的AppID一致
   - 确认 `ConsoleApp1/appsettings.json` 中的WeChat配置已完成

3. **开发者工具设置**
   - 导入小程序项目
   - 选择"通过二维码编译"

4. **二维码编译测试**
   - 选择"快速 二维码编译"
   - 选择桌台二维码图片
   - 观察小程序启动和参数传递

5. **验证结果**
   - 查看控制台输出
   - 检查页面显示
   - 确认参数正确

## ⚠️ **注意事项**

### **1. 配置要求（最重要！）**
- **必须完成WeChat配置**：在生成二维码或测试之前，请先阅读 `README_WeChat_Config.md`
- **AppID必须一致**：`miniprogram-1/project.config.json` 和 `ConsoleApp1/appsettings.json` 中的AppID必须与你的真实AppID一致
- **不要使用他人的AppID**：这会导致二维码无法识别

### **2. 二维码使用**
- **推荐使用现成的二维码**：`桌台二维码/` 文件夹中已准备好的二维码
- **如需生成新二维码**：确保后端服务正常运行，WeChat配置正确
- **验证AccessToken**：确保AccessToken未过期且有效

### **3. 开发者工具**
- 确保AppID配置正确
- 检查基础库版本兼容性
- 开启调试模式

### **4. 测试环境**
- 使用开发版进行测试
- 检查网络连接状态
- 验证参数格式正确

## 🔍 **常见问题**

### **问题1：二维码生成失败**
```
解决方案：
1. 检查后端服务状态
2. 验证WeChat配置
3. 确认AccessToken有效
```

### **问题2：扫码无法启动小程序**
```
解决方案：
1. 检查AppID是否匹配
2. 确认二维码格式正确
3. 验证开发者工具设置
```

### **问题3：参数解析错误**
```
解决方案：
1. 检查二维码生成路径
2. 验证参数格式
3. 查看控制台错误信息
```

## 📋 **测试检查清单**

- [ ] 后端服务正常启动
- [ ] 二维码生成成功
- [ ] 开发者工具配置正确
- [ ] 扫码启动小程序
- [ ] 参数正确传递
- [ ] 页面正常显示
- [ ] 控制台输出正确

## 🎉 **成功标志**

当以下条件都满足时，说明测试成功：

1. ✅ 二维码生成成功
2. ✅ 扫码启动小程序
3. ✅ 桌台信息正确显示
4. ✅ 参数解析无错误
5. ✅ 页面布局正常

---

**总结**：通过这个流程，你可以完整测试从二维码生成到小程序启动的整个流程，确保桌台参数能够正确传递和使用！🚀
