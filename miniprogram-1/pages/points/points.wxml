<!--points.wxml-->
<view class="container">
  <!-- 积分余额卡片 -->
  <view class="balance-card">
    <view class="balance-header">
      <text class="balance-title">我的积分</text>
      <view class="balance-info">
        <text class="balance-amount">{{pointsBalance}}</text>
        <text class="balance-unit">分</text>
      </view>
    </view>
    <view class="balance-desc">
      <text>积分可用于兑换优惠券和商品</text>
    </view>
  </view>

  <!-- 积分记录列表 -->
  <view class="records-section">
    <view class="section-header">
      <text class="section-title">积分明细</text>
    </view>
    
    <!-- 记录列表 -->
    <view class="records-list" wx:if="{{pointsRecords.length > 0}}">
      <view 
        class="record-item" 
        wx:for="{{pointsRecords}}" 
        wx:key="recordId"
        data-orderid="{{item.orderId}}"
        bindtap="goToOrderDetail"
      >
        <view class="record-info">
          <view class="record-header">
            <text class="record-type">{{item.typeInfo.text}}</text>
            <text class="record-time">{{item.formattedTime}}</text>
          </view>
          <view class="record-desc" wx:if="{{item.description}}">
            {{item.description}}
          </view>
          <view class="record-details">
            <text class="store-name" wx:if="{{item.storeName}}">{{item.storeName}}</text>
            <text class="order-amount" wx:if="{{item.orderAmount > 0}}">订单金额: ¥{{item.orderAmount}}</text>
          </view>
        </view>
        <view class="record-points {{item.typeInfo.class}}">
          <text class="points-icon">{{item.typeInfo.icon}}</text>
          <text class="points-amount">{{item.pointsChange}}</text>
        </view>
      </view>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{pointsRecords.length === 0 && !loading}}">
      <image class="empty-icon" src="/images/empty-records.png" mode="aspectFit"></image>
      <text class="empty-text">暂无积分记录</text>
      <text class="empty-desc">完成订单即可获得积分</text>
    </view>

    <!-- 加载中状态 -->
    <view class="loading-more" wx:if="{{loading}}">
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 没有更多数据 -->
    <view class="no-more" wx:if="{{!hasMore && pointsRecords.length > 0}}">
      <text class="no-more-text">没有更多记录了</text>
    </view>
  </view>
</view>