<!--member.wxml-->
<view class="container">
  <!-- 会员卡片 -->
  <view class="member-card">
  <view class="member-card-accent" style="background: linear-gradient(90deg, {{memberInfo.currentLevelInfo.color}}, rgba(255,255,255,0));"></view>
    <view class="member-header">
      <view class="member-level-badge" style="background: {{memberInfo.currentLevelInfo.color}}">
        <text class="level-icon">{{memberInfo.currentLevelInfo.icon}}</text>
        <text class="level-name">{{memberInfo.currentLevelName}}</text>
      </view>
      <view class="member-info">
        <text class="member-name">{{memberInfo.customerName}}</text>
        <text class="member-since">会员时长: {{memberSince}}</text>
      </view>
    </view>
    
    <!-- 消费信息 -->
    <view class="consumption-info">
      <view class="consumption-item">
        <text class="consumption-label">累计消费</text>
        <text class="consumption-value">¥{{memberInfo.totalConsumption}}</text>
      </view>
      <view class="consumption-item">
        <text class="consumption-label">当前积分</text>
        <text class="consumption-value">{{memberInfo.vipPoints}}</text>
      </view>
    </view>

    <!-- 升级进度 -->
    <view class="upgrade-progress" wx:if="{{memberInfo.nextLevel}}">
      <view class="progress-header">
        <text class="progress-title">升级到 {{memberInfo.nextLevelName}}</text>
        <text class="progress-remaining">还需 ¥{{remainingAmount}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{memberInfo.progressToNextLevel}}%"></view>
        <text class="progress-percent">{{memberInfo.progressToNextLevel}}%</text>
      </view>
    </view>
  </view>

  

  <!-- 会员等级体系 -->
  <view class="levels-section">
    <view class="section-title">
      <text>会员等级体系</text>
    </view>
    <scroll-view class="levels-scroll" scroll-x="true" show-scrollbar="{{false}}">
      <view class="levels-row">
        <view 
          class="level-card {{item.levelCode === memberInfo.currentLevel ? 'current' : ''}}"
          wx:for="{{allLevels}}" 
          wx:key="levelCode"
          data-level="{{item}}"
          bindtap="showLevelDetail"
          style="background: {{item.levelColor}}"
        >
          <view class="level-card-top">
            <text class="level-card-icon">{{item.levelIcon}}</text>
            <view class="level-chip" wx:if="{{item.levelCode === memberInfo.currentLevel}}">当前</view>
          </view>
          <view class="level-card-name">{{item.levelName}}</view>
          <view class="level-card-threshold">
            消费满 ¥{{item.minConsumption}}
            <text wx:if="{{item.maxConsumption}}"> - ¥{{item.maxConsumption}}</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 会员特权 -->
  <view class="privileges-section" wx:if="{{memberInfo.privileges.length > 0}}">
    <view class="section-title">
      <text>我的特权</text>
    </view>
    <view class="privileges-list">
      <view class="privilege-item" wx:for="{{memberInfo.privileges}}" wx:key="privilegeType">
        <view class="privilege-icon">{{item.privilegeIcon}}</view>
        <view class="privilege-content">
          <text class="privilege-name">{{item.privilegeName}}</text>
          <text class="privilege-desc">{{item.privilegeDesc}}</text>
        </view>
  <view class="privilege-value" style="border-color: {{memberInfo.currentLevelInfo.color}}; color: {{memberInfo.currentLevelInfo.color}}">{{item.privilegeValue}}</view>
      </view>
    </view>
  </view>
  <view class="privileges-section" wx:else>
    <view class="section-title">
      <text>我的特权</text>
    </view>
    <view class="privileges-list">
      <view class="privilege-item">
        <view class="privilege-icon">ℹ️</view>
        <view class="privilege-content">
          <text class="privilege-name">暂无特权</text>
          <text class="privilege-desc">提升会员等级可解锁更多权益</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 加载中状态 -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">加载中...</text>
  </view>
</view>