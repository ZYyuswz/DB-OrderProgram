<!--member.wxml-->
<view class="container">
  <!-- ä¼šå‘˜å¡ç‰‡ -->
  <view class="member-card">
    <view class="member-header">
      <view class="member-level-badge" style="background: {{memberInfo.currentLevelInfo.color}}">
        <text class="level-icon">{{memberInfo.currentLevelInfo.icon}}</text>
        <text class="level-name">{{memberInfo.currentLevelName}}</text>
      </view>
      <view class="member-info">
        <text class="member-name">{{memberInfo.customerName}}</text>
        <text class="member-since">ä¼šå‘˜æ—¶é•¿: {{memberSince}}</text>
      </view>
    </view>
    
    <!-- æ¶ˆè´¹ä¿¡æ¯ -->
    <view class="consumption-info">
      <view class="consumption-item">
        <text class="consumption-label">ç´¯è®¡æ¶ˆè´¹</text>
        <text class="consumption-value">Â¥{{memberInfo.totalConsumption}}</text>
      </view>
      <view class="consumption-item">
        <text class="consumption-label">å½“å‰ç§¯åˆ†</text>
        <text class="consumption-value">{{memberInfo.vipPoints}}</text>
      </view>
    </view>

    <!-- å‡çº§è¿›åº¦ -->
    <view class="upgrade-progress" wx:if="{{memberInfo.nextLevel}}">
      <view class="progress-header">
        <text class="progress-title">è·ç¦» {{memberInfo.nextLevelName}} è¿˜éœ€</text>
        <text class="progress-amount">Â¥{{remainingAmount}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{memberInfo.progressToNextLevel}}%"></view>
      </view>
      <view class="progress-footer">
        <text class="progress-current">Â¥{{memberInfo.totalConsumption}}</text>
        <text class="progress-target">Â¥{{memberInfo.nextLevelThreshold}}</text>
      </view>
    </view>

    <!-- æœ€é«˜ç­‰çº§æç¤º -->
    <view class="max-level-tip" wx:if="{{!memberInfo.nextLevel}}">
      <text class="tip-icon">ğŸ‘‘</text>
      <text class="tip-text">æ­å–œï¼æ‚¨å·²è¾¾åˆ°æœ€é«˜ä¼šå‘˜ç­‰çº§</text>
    </view>
  </view>

  <!-- ä¼šå‘˜ç‰¹æƒ -->
  <view class="privileges-section">
    <view class="section-title">
      <text>ä¼šå‘˜ç‰¹æƒ</text>
    </view>
    
    <view class="privileges-list">
      <view 
        class="privilege-item" 
        wx:for="{{memberInfo.privileges}}" 
        wx:key="privilegeType"
      >
        <view class="privilege-icon">{{item.privilegeIcon}}</view>
        <view class="privilege-content">
          <view class="privilege-name">{{item.privilegeName}}</view>
          <view class="privilege-desc">{{item.privilegeDesc}}</view>
        </view>
        <view class="privilege-value">{{item.privilegeValue}}</view>
      </view>
    </view>
  </view>

  <!-- æ¶ˆè´¹ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <text>æ¶ˆè´¹ç»Ÿè®¡</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{stats.totalOrders}}</text>
        <text class="stat-label">æ€»è®¢å•æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">Â¥{{stats.averageOrderAmount}}</text>
        <text class="stat-label">å¹³å‡æ¶ˆè´¹</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.monthlyOrders}}</text>
        <text class="stat-label">æœ¬æœˆè®¢å•</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">Â¥{{stats.monthlyConsumption}}</text>
        <text class="stat-label">æœ¬æœˆæ¶ˆè´¹</text>
      </view>
    </view>

    <view class="favorite-store" wx:if="{{stats.favoriteStore}}">
      <text class="store-label">å¸¸å»é—¨åº—: </text>
      <text class="store-name">{{stats.favoriteStore}}</text>
    </view>
  </view>

  <!-- æ‰€æœ‰ç­‰çº§å±•ç¤º -->
  <view class="levels-section">
    <view class="section-title">
      <text>ä¼šå‘˜ç­‰çº§ä½“ç³»</text>
    </view>
    
    <view class="levels-list">
      <view 
        class="level-item {{item.levelCode === memberInfo.currentLevel ? 'current' : ''}}" 
        wx:for="{{allLevels}}" 
        wx:key="levelCode"
        bindtap="showLevelDetail"
        data-level="{{item}}"
      >
        <view class="level-badge">
          <text class="level-icon">{{item.levelIcon}}</text>
        </view>
        <view class="level-info">
          <text class="level-name">{{item.levelName}}</text>
          <text class="level-threshold">
            æ¶ˆè´¹æ»¡Â¥{{item.minConsumption}}
            <text wx:if="{{item.maxConsumption}}"> - Â¥{{item.maxConsumption}}</text>
            <text wx:else="">ä»¥ä¸Š</text>
          </text>
        </view>
        <view class="level-status">
          <text class="status-text" wx:if="{{item.levelCode === memberInfo.currentLevel}}">å½“å‰ç­‰çº§</text>
          <text class="status-icon" wx:else="{{memberInfo.totalConsumption >= item.minConsumption}}">âœ“</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>